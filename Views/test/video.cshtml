
@{
    ViewData["Title"] = "video";
}

<h1>video</h1>

@*<div class="card mb-4">
    <!--Верхняя часть публикации-->
    <div class="row no-gutters">
        <!--Картинка публикации-->
        @if (item.cover_image != null)
        {
        <div class="col-lg-8">
            @Html.Raw(item.content)
        </div>
        }
        <div class="col-lg d-flex flex-column">
            <div class="card-body mb-auto">
                <!--Название публикаци-->
                <h5 class="card-title">@item.title</h5>
                <!--Сокращённое содержимое-->
                @Html.Raw(item.description)<br />
                <small class="text-muted">Опубликовано @item.updated.ToShortDateString()</small>
            </div>
            <div class="p-3 d-flex justify-content-between">
                <div>
                    <!--Кнопки комментарии, нравится, поделиться-->
                    @if (User.Identity.IsAuthenticated)
                    {
                        <form class="d-inline-block" asp-controller="Home" asp-action="AddLike" method="post" data-ajax="true" data-ajax-mode="replace" data-ajax-update="#like_@item.ID">
                            <button id="like_@item.ID" class="btn btn-light align-self-center" type="submit">
                                @if (context.Users.FirstOrDefault(u => u.UserName == User.Identity.Name).likes.FirstOrDefault(l => l.postID == item.ID) != null)
                                {
                                    <i class="far fa-heart text-danger font-weight-bold"></i>
                                }
                                else
                                {
                                    <i class="far fa-heart text-dark"></i>
                                }
                            </button>
                            <input name="postID" value="@item.ID" hidden />
                        </form>
                    }
                    <button class="btn btn-light align-self-center" onclick="$(this).parent().parent().parent().parent().next().collapse('toggle')"><i class="far fa-comment-alt"></i></button>

                    <div class="dropup float-right ml-1">
                        <button class="btn btn-light align-self-center" data-toggle="dropdown"><i class="fas fa-share-alt"></i></button>
                        <div class="dropdown-menu dropdown-menu-right mb-2 p-0 border-0">
                            <div class="btn-group">
                                <a class="btn btn-light" href="https://vk.com/share.php?url=@Url.Action("Details","Home", new {ID= item.ID },this.Context.Request.Scheme)" target="_blank">
                                    <i class="fab fa-vk" style="font-size:large"></i>
                                </a>
                                <a class="btn btn-light" href="https://connect.ok.ru/offer?url=@Url.Action("Details","Home", new {ID= item.ID },this.Context.Request.Scheme)" target="_blank">
                                    <i class="fab fa-odnoklassniki" style="font-size:large"></i>
                                </a>
                                <a class="btn btn-light" href="https://twitter.com/intent/tweet?&url=@Url.Action("Details","Home", new {ID= item.ID },this.Context.Request.Scheme)" target="_blank">
                                    <i class="fab fa-twitter" style="font-size:large"></i>
                                </a>
                                <a class="btn btn-light" href="https://www.facebook.com/sharer.php?u=@Url.Action("Details","Home", new {ID= item.ID },this.Context.Request.Scheme)" target="_blank">
                                    <i class="fab fa-facebook-f" style="font-size:large"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--Комментарии-->
    @if (User.Identity.IsAuthenticated)
    {
        <div class="card-body collapse" data-parent="#accordion">
            <form asp-controller="Home" asp-action="AddComment" method="post" data-ajax="true" data-ajax-mode="replace" data-ajax-update="#comment_@item.ID">
                <div class="card-body p-1">
                    <div class="input-group">
                        <input name="postID" value="@item.ID" hidden />
                        <input name="text" hidden>
                        <input name="fake_text" type="text" class="form-control" placeholder="Напишите комментарий" />
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" type="submit" onclick="$(this).parent().parent().children().first().next().val($(this).parent().parent().children().first().next().next().val()); $(this).parent().parent().children().first().next().next().val('')">Добавить</button>
                        </div>
                    </div>
                </div>
            </form>
            <div id="comment_@item.ID" class="card-body p-3">
                <partial name="_comments" for="@item.comments" />
            </div>
        </div>
    }
    else
    {
        <div class="card-body collapse" data-parent="#accordion">
            <div class="card-body p-1">
                <p class="card-text">Для добавления комментария необходимо <a class="btn-link" href='/Identity/Account/Register'>зарегистрироваться</a> или <a class="btn-link" href='/Identity/Account/Login'>войти</a> на сайт.</p>
            </div>
        </div>
    }
</div>*@


