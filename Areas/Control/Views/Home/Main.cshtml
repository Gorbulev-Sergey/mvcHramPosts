@{
    ViewData["Title"] = "Главная";
    Layout = "~/Areas/Control/Views/Shared/_Layout.cshtml";
}

@inject mvcHramPosts.Areas.Control.Services.IPostsService PostsService

<div class="row">
        @*Новая публикация*@
        <div class="col-md-6 mb-3">
            <div class="rounded bg-light">
                <div class="btn-group btn-block rounded">
                    <button class="btn btn-secondary d-flex justify-content-between align-items-center" data-toggle="collapse" data-target="#p1">Новая публикация<span class="fas fa-chevron-down"></span></button>
                </div>
                <div class="collapse show rounded p-3" id="p1">
                    <div class="accordion" id="a_type">
                        <div class="form-group d-flex align-items-center">
                            <label class="mr-2 col-form-label">Тип: </label>
                            <div class="dropdown flex-grow-1">
                                <button type="button" class="form-control border-0 btn-block d-flex justify-content-between align-items-center" data-toggle="dropdown" aria-expanded="false">
                                    <span>новость</span><span class="fas fa-chevron-down"></span>
                                </button>
                                <div class="dropdown-menu w-100" aria-labelledby="dropdownMenuLink">
                                    <button class="dropdown-item" onclick="$(this).parent().prev().children().first().text($(this).text())" data-toggle="collapse" data-target="#c_article">статья</button>
                                    <button class="dropdown-item" onclick="$(this).parent().prev().children().first().text($(this).text())" data-toggle="collapse" data-target="#c_news">новость</button>
                                    <button class="dropdown-item" onclick="$(this).parent().prev().children().first().text($(this).text())" data-toggle="collapse" data-target="#c_notif">объявление</button>
                                    <button class="dropdown-item" onclick="$(this).parent().prev().children().first().text($(this).text())" data-toggle="collapse" data-target="#c_video">видео</button>
                                </div>
                            </div>
                        </div>

                        <div class="collapse" data-parent="#a_type" id="c_article">
                            <form asp-area="Control" asp-controller="posts" asp-action="Create">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <input name="type" hidden value="@type.article" />
                                <div class="form-group">
                                    <input name="title" class="form-control border-0" type="text" placeholder="Название" />
                                </div>
                                <div class="form-group">
                                    <textarea name="description" class="form-control border-0" rows="2" placeholder="Краткое описание"></textarea>
                                </div>
                                <div class="form-group">
                                    <textarea name="content" class="form-control border-0" rows="2" placeholder="Содержимое"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-check">
                                        <input name="published" class="form-check-input bg-dark" type="checkbox" value="true" checked id="d1">
                                        <label class="form-check-label" for="d1">Опубликовать</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <input name="cover_image" class="form-control border-0" type="text" placeholder="Url обложки публикации" onchange="$(this).next().attr('src', $(this).val())" />
                                    <img class="img-fluid rounded mt-3" src="" />
                                </div>
                                <button class="btn btn-dark" type="submit">Добавить</button>
                            </form>
                        </div>
                        <div class="collapse show" data-parent="#a_type" id="c_news">
                            <form asp-area="Control" asp-controller="posts" asp-action="Create">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <input name="type" hidden value="@type.news" />
                                <div class="form-group">
                                    <input name="title" class="form-control border-0" type="text" placeholder="Название" />
                                </div>
                                <div class="form-group">
                                    <textarea name="description" class="form-control border-0" rows="2" placeholder="Краткое описание"></textarea>
                                </div>
                                <div class="form-group">
                                    <textarea name="content" class="form-control border-0" rows="2" placeholder="Содержимое"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-check">
                                        <input name="published" class="form-check-input bg-dark" type="checkbox" value="true" checked id="d2">
                                        <label class="form-check-label" for="d2">Опубликовать</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <input name="cover_image" class="form-control border-0" type="text" placeholder="Url обложки публикации" onchange="$(this).next().attr('src', $(this).val())" />
                                    <img class="img-fluid rounded mt-3" src="" />
                                </div>
                                <button class="btn btn-dark" type="submit">Добавить</button>
                            </form>
                        </div>
                        <div class="collapse" data-parent="#a_type" id="c_notif">
                            <form asp-area="Control" asp-controller="posts" asp-action="Create">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <input name="type" hidden value="@type.notification" />
                                <div class="form-group">
                                    <input name="title" class="form-control border-0" type="text" placeholder="Название" />
                                </div>
                                <div class="form-group">
                                    <textarea name="description" class="form-control border-0" rows="2" placeholder="Краткое описание"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-check">
                                        <input name="published" class="form-check-input bg-dark" type="checkbox" value="true" checked id="d3">
                                        <label class="form-check-label" for="d3">Опубликовать</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <input name="cover_image" class="form-control border-0" type="text" placeholder="Url обложки публикации" onchange="$(this).next().attr('src', $(this).val())" />
                                    <img class="img-fluid rounded mt-3" src="" />
                                </div>
                                <button class="btn btn-dark" type="submit">Добавить</button>
                            </form>
                        </div>
                        <div class="collapse" data-parent="#a_type" id="c_video">
                            <form asp-area="Control" asp-controller="posts" asp-action="Create">
                                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                <input name="type" hidden value="@type.video" />
                                <div class="form-group">
                                    <input name="title" class="form-control border-0" type="text" placeholder="Название" />
                                </div>
                                <div class="form-group">
                                    <textarea name="desсription" class="form-control border-0" rows="2" placeholder="Краткое описание"></textarea>
                                </div>
                                <div class="form-group">
                                    <div class="form-check">
                                        <input name="published" class="form-check-input bg-dark" type="checkbox" value="true" checked id="d4">
                                        <label class="form-check-label" for="d4">Опубликовать</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <input name="content" hidden />
                                    <input class="form-control border-0" type="text" placeholder="Url видео" onchange="$(this).next().children().first().children().first().attr('src', $(this).val()); $(this).prev().val($(this).next().html())" />
                                    <div>
                                        <div class="embed-responsive d-block mr-auto ml-auto mt-3 mb-3 embed-responsive-21by9" style="width: 100%;">
                                            <iframe class="embed-responsive-item" src="" allowfullscreen></iframe>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-dark" type="submit">Добавить</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @*Статистика*@
        <div class="col-md-6 mb-3">
            <div class="rounded bg-light">
                <div class="btn-group btn-block rounded">
                    <button class="btn btn-secondary d-flex justify-content-between align-items-center" data-toggle="collapse" data-target="#p2">Статистика<span class="fas fa-chevron-down"></span></button>
                </div>
                <div class="collapse show rounded p-3" id="p2">
                    <div class="row">
                        <div class="col">
                            <h6>Публикаций:</h6>
                            <p class=" d-flex justify-content-between align-items-center">всего <span class="badge badge-dark">@PostsService.posts().Result.Count()</span></p>
                            <p class=" d-flex justify-content-between align-items-center">опубликованных <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == true).Count()</span></p>
                            <p class=" d-flex justify-content-between align-items-center">неопубликованных <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == false).Count()</span></p>
                        </div>
                        <div class="col">
                            <h6>Опубликованных:</h6>
                            <p class=" d-flex justify-content-between align-items-center">статей <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == true && p.type == type.article).Count()</span></p>
                            <p class=" d-flex justify-content-between align-items-center">новостей <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == true && p.type == type.news).Count()</span></p>
                            <p class=" d-flex justify-content-between align-items-center">объявлений <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == true && p.type == type.notification).Count()</span></p>
                            <p class=" d-flex justify-content-between align-items-center">видеозаписей <span class="badge badge-dark">@PostsService.posts().Result.Where(p => p.published == true && p.type == type.video).Count()</span></p>
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
 </div>


    @section Scripts {
        @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    }


